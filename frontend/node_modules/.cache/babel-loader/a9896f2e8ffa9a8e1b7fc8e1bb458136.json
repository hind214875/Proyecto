{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\Tarea3\\\\frontend\\\\src\\\\components\\\\AuthContext.js\";\nimport React, { createContext, useState, useEffect, useContext } from \"react\";\nconst AuthContext = createContext(null);\nexport const AuthProvider = ({\n  children\n}) => {\n  const [authState, setAuthState] = useState(JSON.parse(localStorage.getItem(\"authData\")));\n  const [professionalId, setProfessionalId] = useState(JSON.parse(localStorage.getItem(\"professionalId\")));\n  useEffect(() => {\n    // Fetch professionalId when authState changes and is a professional\n    if (authState && authState.tipo === \"professional\" && authState.usuario_id) {\n      fetchProfessionalId(authState.usuario_id);\n    }\n  }, [authState]);\n  const fetchProfessionalId = async usuarioId => {\n    try {\n      const response = await fetch(`http://localhost/Tarea3/backend/src/index.php/getProfessionalId`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          usuario_id: usuarioId\n        })\n      });\n      const data = await response.json();\n      if (data.profesional_id) {\n        localStorage.setItem(\"professionalId\", JSON.stringify(data.profesional_id));\n        setProfessionalId(data.profesional_id);\n      } else {\n        throw new Error(data.message || \"Failed to fetch professional ID\");\n      }\n    } catch (error) {\n      console.error(\"Error fetching professional ID:\", error.message);\n    }\n  };\n  const signIn = userData => {\n    localStorage.setItem(\"authData\", JSON.stringify(userData));\n    setAuthState(userData);\n  };\n  const signOut = () => {\n    localStorage.removeItem(\"authData\");\n    localStorage.removeItem(\"professionalId\");\n    setAuthState(null);\n    setProfessionalId(null);\n  };\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      authState,\n      professionalId,\n      signIn,\n      signOut\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, children);\n};\nexport const useAuth = () => useContext(AuthContext);","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","AuthContext","AuthProvider","children","authState","setAuthState","JSON","parse","localStorage","getItem","professionalId","setProfessionalId","tipo","usuario_id","fetchProfessionalId","usuarioId","response","fetch","method","headers","body","stringify","data","json","profesional_id","setItem","Error","message","error","console","signIn","userData","signOut","removeItem","createElement","Provider","value","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","useAuth"],"sources":["C:/xampp/htdocs/Tarea3/frontend/src/components/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from \"react\";\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [authState, setAuthState] = useState(\r\n    JSON.parse(localStorage.getItem(\"authData\"))\r\n  );\r\n  const [professionalId, setProfessionalId] = useState(\r\n    JSON.parse(localStorage.getItem(\"professionalId\"))\r\n  );\r\n\r\n  useEffect(() => {\r\n    // Fetch professionalId when authState changes and is a professional\r\n    if (\r\n      authState &&\r\n      authState.tipo === \"professional\" &&\r\n      authState.usuario_id\r\n    ) {\r\n      fetchProfessionalId(authState.usuario_id);\r\n    }\r\n  }, [authState]);\r\n\r\n  const fetchProfessionalId = async (usuarioId) => {\r\n    try {\r\n      const response = await fetch(\r\n        `http://localhost/Tarea3/backend/src/index.php/getProfessionalId`,\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify({ usuario_id: usuarioId }),\r\n        }\r\n      );\r\n      const data = await response.json();\r\n      if (data.profesional_id) {\r\n        localStorage.setItem(\r\n          \"professionalId\",\r\n          JSON.stringify(data.profesional_id)\r\n        );\r\n        setProfessionalId(data.profesional_id);\r\n      } else {\r\n        throw new Error(data.message || \"Failed to fetch professional ID\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching professional ID:\", error.message);\r\n    }\r\n  };\r\n\r\n  const signIn = (userData) => {\r\n    localStorage.setItem(\"authData\", JSON.stringify(userData));\r\n    setAuthState(userData);\r\n  };\r\n\r\n  const signOut = () => {\r\n    localStorage.removeItem(\"authData\");\r\n    localStorage.removeItem(\"professionalId\");\r\n    setAuthState(null);\r\n    setProfessionalId(null);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{ authState, professionalId, signIn, signOut }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAE7E,MAAMC,WAAW,GAAGJ,aAAa,CAAC,IAAI,CAAC;AAEvC,OAAO,MAAMK,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAC5C,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGP,QAAQ,CACxCQ,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CAC7C,CAAC;EACD,MAAM,CAACC,cAAc,EAAEC,iBAAiB,CAAC,GAAGb,QAAQ,CAClDQ,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAC,CACnD,CAAC;EAEDV,SAAS,CAAC,MAAM;IACd;IACA,IACEK,SAAS,IACTA,SAAS,CAACQ,IAAI,KAAK,cAAc,IACjCR,SAAS,CAACS,UAAU,EACpB;MACAC,mBAAmB,CAACV,SAAS,CAACS,UAAU,CAAC;IAC3C;EACF,CAAC,EAAE,CAACT,SAAS,CAAC,CAAC;EAEf,MAAMU,mBAAmB,GAAG,MAAOC,SAAS,IAAK;IAC/C,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CACzB,iEAAgE,EACjE;QACEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAEd,IAAI,CAACe,SAAS,CAAC;UAAER,UAAU,EAAEE;QAAU,CAAC;MAChD,CACF,CAAC;MACD,MAAMO,IAAI,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;MAClC,IAAID,IAAI,CAACE,cAAc,EAAE;QACvBhB,YAAY,CAACiB,OAAO,CAClB,gBAAgB,EAChBnB,IAAI,CAACe,SAAS,CAACC,IAAI,CAACE,cAAc,CACpC,CAAC;QACDb,iBAAiB,CAACW,IAAI,CAACE,cAAc,CAAC;MACxC,CAAC,MAAM;QACL,MAAM,IAAIE,KAAK,CAACJ,IAAI,CAACK,OAAO,IAAI,iCAAiC,CAAC;MACpE;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAACD,OAAO,CAAC;IACjE;EACF,CAAC;EAED,MAAMG,MAAM,GAAIC,QAAQ,IAAK;IAC3BvB,YAAY,CAACiB,OAAO,CAAC,UAAU,EAAEnB,IAAI,CAACe,SAAS,CAACU,QAAQ,CAAC,CAAC;IAC1D1B,YAAY,CAAC0B,QAAQ,CAAC;EACxB,CAAC;EAED,MAAMC,OAAO,GAAGA,CAAA,KAAM;IACpBxB,YAAY,CAACyB,UAAU,CAAC,UAAU,CAAC;IACnCzB,YAAY,CAACyB,UAAU,CAAC,gBAAgB,CAAC;IACzC5B,YAAY,CAAC,IAAI,CAAC;IAClBM,iBAAiB,CAAC,IAAI,CAAC;EACzB,CAAC;EAED,oBACEf,KAAA,CAAAsC,aAAA,CAACjC,WAAW,CAACkC,QAAQ;IACnBC,KAAK,EAAE;MAAEhC,SAAS;MAAEM,cAAc;MAAEoB,MAAM;MAAEE;IAAQ,CAAE;IAAAK,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAErDvC,QACmB,CAAC;AAE3B,CAAC;AAED,OAAO,MAAMwC,OAAO,GAAGA,CAAA,KAAM3C,UAAU,CAACC,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}